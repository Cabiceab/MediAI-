<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vyle - Enhanced Medical AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a73e8;
            --secondary-color: #4caf50;
        }

        .chat-container {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            background: #f8f9fa;
        }

        .message {
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 20px;
            max-width: 80%;
        }

        .user-message {
            background: var(--primary-color);
            color: white;
            margin-left: auto;
        }

        .bot-message {
            background: #fff;
            border: 1px solid #ddd;
        }

        .progress-indicator {
            height: 4px;
            background: #eee;
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .diagnosis-card {
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .diagnosis-card:hover {
            transform: translateY(-3px);
        }

        .drop-zone {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
        }

        .drop-zone.dragover {
            border-color: var(--primary-color);
            background: rgba(26, 115, 232, 0.05);
        }
    </style>
</head>
<body>
    <div class="container py-4">
        <h1 class="text-center mb-4">ü©∫ Vyle Medical AI System</h1>

        <div class="row g-4">
            <!-- Input Section -->
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        Patient Assessment
                    </div>
                    <div class="card-body">
                        <div class="progress-indicator">
                            <div class="progress-bar" style="width: 0%"></div>
                        </div>

                        <div id="chatBox" class="chat-container">
                            <div class="message bot-message">
                                <i class="fas fa-robot text-primary me-2"></i>
                                Hello! Please describe your symptoms or upload medical images.
                            </div>
                        </div>

                        <div class="input-group mb-3">
                            <input type="text" id="symptomInput" class="form-control" 
                                   placeholder="Enter symptoms (e.g., fever, headache)">
                            <button class="btn btn-primary" onclick="analyzeSymptoms()">
                                <i class="fas fa-analyze me-2"></i>Analyze
                            </button>
                        </div>

                        <div class="drop-zone" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)">
                            <p>Drag & drop medical images here or click to upload</p>
                            <input type="file" id="medicalImage" class="form-control d-none" 
                                   accept="image/*" onchange="handleImageUpload(event)">
                            <button class="btn btn-secondary mt-2" onclick="document.getElementById('medicalImage').click()">
                                <i class="fas fa-upload me-2"></i>Upload Images
                            </button>
                        </div>
                        <div id="imagePreview" class="mt-3 text-center"></div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="col-md-4">
                <div class="card shadow h-100">
                    <div class="card-header bg-success text-white">
                        Analysis Results
                    </div>
                    <div class="card-body">
                        <div id="resultsAccordion" class="accordion"></div>
                        <div id="loading" class="text-center mt-3" style="display: none;">
                            <div class="spinner-border text-primary" role="status"></div>
                            <p class="mt-2">Analyzing...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-4 text-center text-muted small">
            <div class="alert alert-warning d-inline-block">
                ‚ö†Ô∏è This system provides preliminary information only. Always consult a healthcare professional.
            </div>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Medical AI System
        class VyleAI {
            constructor() {
                this.conversationHistory = [];
            }

            async analyzeSymptoms(symptoms) {
                showLoading(true);
                updateProgress(30);
                
                try {
                    // Simulated API call
                    const response = await this.mockDiagnosisAPI(symptoms);
                    updateProgress(70);
                    
                    this.displayResults(response);
                    updateProgress(100);
                } catch (error) {
                    this.showError(error.message);
                } finally {
                    showLoading(false);
                }
            }

            async analyzeImage(file) {
                showLoading(true);
                updateProgress(20);
                
                try {
                    // Simulated image analysis
                    const result = await this.mockImageAnalysis(file);
                    updateProgress(80);
                    
                    this.displayImageResults(result);
                    updateProgress(100);
                } catch (error) {
                    this.showError(error.message);
                } finally {
                    showLoading(false);
                }
            }

            mockDiagnosisAPI(symptoms) {
                return new Promise(resolve => {
                    setTimeout(() => {
                        resolve({
                            conditions: [
                                {
                                    name: "Influenza",
                                    probability: "75%",
                                    description: "Viral infection affecting respiratory system",
                                    recommendations: ["Rest", "Hydration", "Antipyretics"]
                                },
                                {
                                    name: "Common Cold",
                                    probability: "20%",
                                    description: "Mild upper respiratory infection",
                                    recommendations: ["Rest", "Nasal decongestants"]
                                }
                            ]
                        });
                    }, 1500);
                });
            }

            mockImageAnalysis(file) {
                return new Promise(resolve => {
                    setTimeout(() => {
                        resolve({
                            condition: "Pneumonia",
                            confidence: "85%",
                            findings: "Consolidation in lower right lobe"
                        });
                    }, 2000);
                });
            }

            displayResults(results) {
                const accordion = document.getElementById('resultsAccordion');
                accordion.innerHTML = results.conditions.map((condition, index) => `
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" 
                                    data-bs-toggle="collapse" data-bs-target="#condition-${index}">
                                ${condition.name} (${condition.probability})
                            </button>
                        </h2>
                        <div id="condition-${index}" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                <p>${condition.description}</p>
                                <h6>Recommendations:</h6>
                                <ul class="list-group">
                                    ${condition.recommendations.map(r => `
                                        <li class="list-group-item">${r}</li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            displayImageResults(results) {
                const accordion = document.getElementById('resultsAccordion');
                accordion.innerHTML = `
                    <div class="alert alert-info">
                        <h5>Image Analysis Results</h5>
                        <p>Condition: ${results.condition}</p>
                        <p>Confidence: ${results.confidence}</p>
                        <p>Findings: ${results.findings}</p>
                    </div>
                `;
            }

            showError(message) {
                const chatBox = document.getElementById('chatBox');
                chatBox.innerHTML += `
                    <div class="message bot-message text-danger">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        ${message}
                    </div>
                `;
            }
        }

        // UI Functions
        const vyle = new VyleAI();

        function analyzeSymptoms() {
            const symptoms = document.getElementById('symptomInput').value;
            if (!symptoms) return;
            
            addMessage(symptoms, 'user');
            vyle.analyzeSymptoms(symptoms.split(/\s*,\s*/));
            document.getElementById('symptomInput').value = '';
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                previewImage(file);
                vyle.analyzeImage(file);
            }
        }

        function previewImage(file) {
            const preview = document.getElementById('imagePreview');
            const reader = new FileReader();
            
            reader.onload = (e) => {
                preview.innerHTML = `
                    <img src="${e.target.result}" class="img-fluid rounded shadow" 
                         style="max-height: 200px" alt="Medical preview">
                `;
            };
            reader.readAsDataURL(file);
        }

        function addMessage(content, type = 'bot') {
            const chatBox = document.getElementById('chatBox');
            chatBox.innerHTML += `
                <div class="message ${type}-message">
                    ${type === 'bot' ? '<i class="fas fa-robot text-primary me-2"></i>' : ''}
                    ${content}
                </div>
            `;
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function updateProgress(percentage) {
            document.querySelector('.progress-bar').style.width = `${percentage}%`;
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // Drag & Drop Handlers
        function dragOverHandler(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function dropHandler(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageUpload({ target: { files } });
            }
        }
    </script>
</body>
</html>
